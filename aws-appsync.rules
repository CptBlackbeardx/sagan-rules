# Sagan aws-appsync.rules
# Copyright (c) 2009-2023. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************

# rules by "Bryant Smith" <bsmith@quadrantsec.com>
# 04/12/2023

#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (AssociateApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|AssociateApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011760; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateApiCache) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateApiCache"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011761; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateApiKey) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateApiKey"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011762; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateDataSource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateDataSource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011763; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateDomainName) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateDomainName"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011764; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateFunction) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateFunction"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011765; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateGraphqlApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateGraphqlApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011766; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateResolver) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateResolver"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011767; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (CreateType) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|CreateType"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011768; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteApiCache) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteApiCache"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011769; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteApiKey) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteApiKey"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011770; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteDataSource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteDataSource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011771; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteDomainName) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteDomainName"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011772; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteFunction) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteFunction"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011773; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteGraphqlApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteGraphqlApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011774; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteResolver) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteResolver"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011775; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DeleteType) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DeleteType"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011776; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (DisassociateApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|DisassociateApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011777; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (EvaluateCode) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|EvaluateCode"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011778; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (EvaluateMappingTemplate) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|EvaluateMappingTemplate"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011779; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (FlushApiCache) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|FlushApiCache"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011780; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetApiAssociation) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetApiAssociation"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011781; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetApiCache) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetApiCache"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011782; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetDataSource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetDataSource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011783; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetDomainName) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetDomainName"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011784; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetFunction) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetFunction"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011785; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetGraphqlApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetGraphqlApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011786; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetIntrospectionSchema) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetIntrospectionSchema"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011787; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetResolver) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetResolver"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011788; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetSchemaCreationStatus) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetSchemaCreationStatus"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011789; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (GetType) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|GetType"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011790; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListApiKeys) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListApiKeys"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011791; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListDataSources) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListDataSources"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011792; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListDomainNames) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListDomainNames"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011793; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListFunctions) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListFunctions"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011794; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListGraphqlApis) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListGraphqlApis"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011795; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListResolvers) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListResolvers"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011796; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListResolversByFunction) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListResolversByFunction"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011797; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListTagsForResource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListTagsForResource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011798; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (ListTypes) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|ListTypes"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011799; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (StartSchemaCreation) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|StartSchemaCreation"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011800; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (TagResource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|TagResource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011801; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UntagResource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UntagResource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011802; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateApiCache) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateApiCache"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011803; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateApiKey) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateApiKey"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011804; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateDataSource) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateDataSource"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011805; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateDomainName) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateDomainName"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011806; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateFunction) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateFunction"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011807; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateGraphqlApi) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateGraphqlApi"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011808; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateResolver) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateResolver"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011809; rev:1;)
#alert any $HOME_NET any -> $HOME_NET any (msg:"[APPSYNC] AppSync event detected (UpdateType) "; program:appsync.amazonaws.com; content:"eventName|22 3a 20 22|UpdateType"; classtype:system-event; reference:url,docs.aws.amazon.com/appsync/latest/APIReference/Welcome.html; sid:5011810; rev:1;)
