# Sagan fortinet.rules
# Copyright (c) 2009-2022. Quadrant Information Security <www.quadrantsec.com>
# All rights reserved.
#
# Please submit any custom rules or ideas to sagan-submit@quadrantsec.com or the sagan-sigs mailing list
#
#*************************************************************
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
# These are mostly taken from Fortigate 6.4.8 Message reference manual.

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPS Session Scan Paused"; content: "logid=|22|0100022700|22|"; classtype: system-error; reference: url,wiki.quadrantsec.com/bin/view/Main/5000898; sid: 5000898; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Compromised Host Detected"; content: "logid=|22|0100022953|22|"; classtype: malware; reference: url,wiki.quadrantsec.com/bin/view/Main/5000899; sid: 5000899; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FortiGuard Message Service Status"; content: "logid=|22|0100022163|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000900; sid: 5000900; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] IPv6 firewall inbound policy added"; content: "logid=|22|0100032151|22|"; classtype: configuration-change; reference: url,wiki.quadrantsec.com/bin/view/Main/5000901; sid: 5000901

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Successful Admin Login"; content: "logid=|22|0100032001|22|"; classtype: successful-admin; reference: url,wiki.quadrantsec.com/bin/view/Main/5000902; sid: 5000902; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Failed"; content: "logid=|22|0100032002|22|"; classtype: attempted-admin; reference: url,wiki.quadrantsec.com/bin/view/Main/5000903; sid: 5000903; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin logout successful"; content: "logid=|22|0100032003|22|"; classtype: not-suspicious; reference: url,wiki.quadrantsec.com/bin/view/Main/5000904; sid: 5000904; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VDOM overwritten by Admin"; content: "logid=|22|0100032005|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000905; sid: 5000905; rev:12;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super admin entered VDOM"; content: "logid=|22|0100032006|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000906; sid: 5000906; rev:4;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Super admin left VDOM"; content: "logid=|22|0100032007|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000907; sid: 5000907; rev:4;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] FortiGate Started"; content: "logid=|22|0100032009|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000908; sid: 5000908; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Logs deleted by user"; content: "logid=|22|0100032044|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000909; sid: 5000909; rev:5;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Support License expiring"; content: "logid=|22|0100032014|22|"; classtype: program-error; reference: url,wiki.quadrantsec.com/bin/view/Main/5000910; sid: 5000910; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Corrupted MAC packet detected"; content: "logid=|22|0100032020|22|"; classtype: network-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000911; sid: 5000911; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Performed Action from GUI"; content: "logid=|22|0100032095|22|"; classtype: configuration-change; reference: url,wiki.quadrantsec.com/bin/view/Main/5000912; sid: 5000912; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Configuration change"; content: "logid=|22|0100032102|22|"; classtype: configuration-change; reference: url,wiki.quadrantsec.com/bin/view/Main/5000913; sid: 5000913; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] New Firmware Available on FortiGuard"; content: "logid=|22|0100032103"; classtype: not-suspicious; reference: url,wiki.quadrantsec.com/bin/view/Main/5000914; sid: 5000914; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Password Expired"; content: "logid=|22|0100032024|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000915; sid: 5000915; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication success"; content: "logid=|22|0100029002|22|"; classtype: successful-user; reference: url,wiki.quadrantsec.com/bin/view/Main/5000916; sid: 5000916; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Authentication failed"; content: "logid=|22|0100029003|22|"; classtype: unsuccessful-user; reference: url,wiki.quadrantsec.com/bin/view/Main/5000917; sid: 5000917; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] L2TP/PPTP/PPPoE Max connection reached"; content: "logid=|22|0101040014|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000918; sid: 5000918; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Data Leak Prevention Rule Matched"; content: "logid=|22|0954024576|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000919; sid: 5000919; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant messaging message"; content: "logid=|22|1059028672|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000920; sid: 5000920; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message file tranfer message"; content: "logid=|22|1059028675|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000921; sid: 5000921; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Application control instant message chat message"; content: "logid=|22|1059028676|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000922; sid: 5000922; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] VoIP-SIP session blocked"; content: "logid=|2|0814044033|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000923; sid: 5000923; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected Within Email"; content: "logid=|22|0211008194|22|"; classtype: suspicious-traffic; reference: url,wiki.quadrantsec.com/bin/view/Main/5000924; sid: 5000924; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Signature"; content: "logid=|22|0419016384|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000925; sid: 5000925; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by ICMP Signature"; content: "logid=|22|0419016385|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000926; sid: 5000926; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Other Signature"; content: "logid=|22|0419016386|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000927; sid: 5000927; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack detected by Malicious URL"; content: "logid=|22|0421016399|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000928; sid: 5000928; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Botnet C&C Communication - Warning"; content: "logid=|22|0402016400|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000929; sid: 5000929; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web - Banned word was found"; content: "logid=|22|0314012288|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000930; sid: 5000930; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed Entirely"; content: "logid=|22|0336013601|22|"; classtype: web-application-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5000931; sid: 5000931; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Cookie Removed"; content: "logid=|22|0336013573|22|"; classtype: web-application-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5000932; sid: 5000932; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Java applet was removed"; content: "logid=|22|0337013584|22|"; classtype: web-application-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5000933; sid: 5000933; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] ActiveX script was removed"; content: "logid=|22|0335013568|22|"; classtype: web-application-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5000934; sid: 5000934; rev:3;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Script Entity Removed"; content: "logid=|22|0341013600|22|"; classtype: web-application-activity; reference: url,wiki.quadrantsec.com/bin/view/Main/5000935; sid: 5000935; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Blocked per Filter"; content: "logid=|22|0315012544|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000936; sid: 5000936; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Exempt per Filter"; content: "logid=|22|0315012545|22|"; classtype: not-suspicious; reference: url,wiki.quadrantsec.com/bin/view/Main/5000937; sid: 5000937; rev:2;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Allowed per Filter"; content: "logid=|22|0315012546|22|"; classtype: not-suspicious; reference: url,wiki.quadrantsec.com/bin/view/Main/5000938; sid: 5000938; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Blocked Category Within Firewall Policy"; content: "logid=|22|0316013056|22|"; classtype: policy-violation; reference: url,wiki.quadrantsec.com/bin/view/Main/5000939; sid: 5000939; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] URL Belongs to Allowed Category Within Firewall Policy"; content: "logid=|22|0317013312|22|"; classtype: not-suspicious; reference: url,wiki.quadrantsec.com/bin/view/Main/5000940; sid: 5000940; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  Outdated Report Files Deleted"; content: "logid=|22|0100020027|22|"; classtype: system-event; threshold: type limit, track by_src, count 1, seconds 86400; reference: url,wiki.quadrantsec.com/bin/view/Main/5000941; sid: 5000941; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  Disk Log File Deleted"; content: "logid=|22|0100032029|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000942; sid: 5000942; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  New SSL VPN Connection"; content: "logid=|22|0101039943|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000943; sid: 5000943; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET]  SSL Decryption Failed"; content: "logid=|22|0105048009|22|"; classtype: system-error; reference: url,wiki.quadrantsec.com/bin/view/Main/5000944; sid: 5000944; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL VPN Alert"; content: "logid=|22|0101039944|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000945; sid: 5000945; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Fatal Alert Received"; content: "logid=|22|0105048038|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000946; sid: 5000946; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logon"; content: "logid=|22|0102043039|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000947; sid: 5000947; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Authentication Logout"; content: "logid=|22|0102043040|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000948; sid: 5000948; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Report Deleted"; content: "logid=|22|0100032040|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000949; sid: 5000949; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Monitor login Successful"; content: "logid=|22|0100032053|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000950; sid: 5000950; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Infected File Detected"; content: "logid=|22|0211008192|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000951; sid: 5000951; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Virus Command Blocked"; content: "logid=|22|020608452|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000952; sid: 5000952; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Pass"; content: "logid=|22|1059028704|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000953; sid: 5000953; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] App-Control IPS Pass"; content: "logid=|22|1059028705|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000954; sid: 5000954; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blocked"; content: "logid=|22|1700062303|22|"; classtype: suspicious-traffic; reference: url,wiki.quadrantsec.com/bin/view/Main/5000955; sid: 5000955; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - Blacklisted"; content: "logid=|22|1700062300|22|"; classtype: suspicious-traffic; reference: url,wiki.quadrantsec.com/bin/view/Main/5000956; sid: 5000956; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] SSL Certificate Anomaly - SNI Mismatched"; content: "logid=|22|1700062304|22|"; classtype: suspicious-traffic; reference: url,wiki.quadrantsec.com/bin/view/Main/5000957; sid: 5000957; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] DNS - Domain Belongs to a Denied Category in Policy"; content: "logid=|22|1501054803|22|"; classtype: suspicious-traffic; reference: url,wiki.quadrantsec.com/bin/view/Main/5000958; sid: 5000958; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Web Filter Rating Error Occurred"; content: "logid=|22|0318012800|22|"; classtype: system-error; reference: url,wiki.quadrantsec.com/bin/view/Main/5000959; sid: 5000959; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by UDP/TCP Anomaly"; content: "logid=|22|0720018432|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000960; sid: 5000960; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by ICMP Anomaly"; content: "logid=|22|0720018433|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000961; sid: 5000961; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Attack Detected by Other Anomaly"; content: "logid=|22|0720018434|22|"; classtype: misc-attack; reference: url,wiki.quadrantsec.com/bin/view/Main/5000962; sid: 5000962; rev:1;)

alert any $EXTERNAL_NET any -> $HOME_NET any (msg: "[FORTINET] Admin Login Disabled"; content: "logid=|22|0100032021|22|"; classtype: system-event; reference: url,wiki.quadrantsec.com/bin/view/Main/5000963; sid: 5000963; rev:3;)
